<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productivity Dashboard</title>
    
    <!-- Firebase SDKs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-card: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border: #e5e7eb;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .nav {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-btn {
            padding: 10px 20px;
            background: transparent;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            color: var(--text-primary);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-btn:hover, .nav-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .dark-toggle {
            background: var(--bg-secondary);
            border: none;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .logout-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
        }

        /* Login Screen Styles */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-card {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-lg);
        }

        .login-logo {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .login-title {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: var(--text-secondary);
            margin-bottom: 30px;
        }

        .google-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 15px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .google-login-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .google-icon {
            width: 20px;
            height: 20px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .app-content {
            display: none;
        }

        .app-content.active {
            display: block;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .card h3 {
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .task-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .task-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .btn {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-danger {
            background: var(--danger);
        }

        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 8px;
            background: var(--bg-secondary);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .timer {
            text-align: center;
        }

        .timer-display {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
            color: var(--primary);
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
        }

        .habit-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .habit-streak {
            background: var(--secondary);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .quote-widget {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 15px;
        }

        .quote-text {
            font-style: italic;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .quote-author {
            opacity: 0.8;
            font-size: 14px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 5px;
        }

        .chart-container {
            height: 300px;
            background: var(--bg-card);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            margin: 20px;
        }

        .celebration {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .sync-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: var(--text-secondary);
            margin-left: 10px;
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            .header {
                flex-direction: column;
                gap: 15px;
            }
            .nav {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading active">
        <div style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 20px;">⏳</div>
            <p>Loading your productivity dashboard...</p>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="login-screen" style="display: none;">
        <div class="login-card">
            <div class="login-logo">📊</div>
            <h1 class="login-title">Productivity Dashboard</h1>
            <p class="login-subtitle">Sign in to save your progress and sync across devices</p>
            
            <button class="google-login-btn" onclick="signInWithGoogle()">
                <svg class="google-icon" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                Continue with Google
            </button>
            
            <div style="margin-top: 20px; font-size: 12px; color: var(--text-secondary);">
                Secure authentication powered by Firebase
            </div>
        </div>
    </div>

    <!-- Main App Content -->
    <div id="app-content" class="app-content">
        <div class="container">
            <header class="header">
                <div class="logo">📊 Productivity Dashboard</div>
                <nav class="nav">
                    <button class="nav-btn active" onclick="showPage('dashboard')">Dashboard</button>
                    <button class="nav-btn" onclick="showPage('stats')">Statistics</button>
                    <button class="nav-btn" onclick="showPage('about')">About</button>
                    <button class="dark-toggle" onclick="toggleDarkMode()">🌙</button>
                    <div class="user-info">
                        <img id="user-avatar" class="user-avatar" src="" alt="User">
                        <span id="user-name"></span>
                        <div class="sync-indicator">
                            <div class="sync-dot"></div>
                            <span>Synced</span>
                        </div>
                        <button class="logout-btn" onclick="signOut()">Logout</button>
                    </div>
                </nav>
            </header>

            <div id="dashboard-page" class="page active">
                <div class="dashboard">
                    <!-- Daily Goals Tracker -->
                    <div class="card">
                        <h3>🎯 Daily Goals</h3>
                        <div class="task-input">
                            <input type="text" id="task-input" placeholder="Add a new goal..." onkeypress="handleTaskInput(event)">
                            <button class="btn" onclick="addTask()">Add</button>
                        </div>
                        <ul class="task-list" id="task-list"></ul>
                    </div>

                    <!-- Study Timer -->
                    <div class="card">
                        <h3>🍅 Study Timer</h3>
                        <div class="timer">
                            <div class="timer-display" id="timer-display">25:00</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="timer-progress"></div>
                            </div>
                            <div class="timer-controls">
                                <button class="btn" onclick="startTimer()">Start</button>
                                <button class="btn btn-secondary" onclick="pauseTimer()">Pause</button>
                                <button class="btn btn-danger" onclick="resetTimer()">Reset</button>
                            </div>
                            <div>
                                <label>
                                    <input type="radio" name="timer-mode" value="pomodoro" checked> 
                                    Pomodoro (25min)
                                </label>
                                <label style="margin-left: 15px;">
                                    <input type="radio" name="timer-mode" value="break"> 
                                    Break (5min)
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Habit Tracker -->
                    <div class="card">
                        <h3>✅ Habit Tracker</h3>
                        <div class="task-input">
                            <input type="text" id="habit-input" placeholder="Add a new habit..." onkeypress="handleHabitInput(event)">
                            <button class="btn" onclick="addHabit()">Add</button>
                        </div>
                        <div id="habit-list"></div>
                    </div>

                    <!-- Quote Widget -->
                    <div class="card">
                        <div class="quote-widget" id="quote-widget">
                            <div class="quote-text" id="quote-text">"The future depends on what you do today."</div>
                            <div class="quote-author" id="quote-author">- Mahatma Gandhi</div>
                            <button class="btn" onclick="newQuote()" style="margin-top: 15px; background: rgba(255,255,255,0.2);">New Quote</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="stats-page" class="page">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-study-time">0</div>
                        <div class="stat-label">Hours Studied Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completed-tasks">0</div>
                        <div class="stat-label">Tasks Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="habit-streak">0</div>
                        <div class="stat-label">Best Habit Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="productivity-score">0%</div>
                        <div class="stat-label">Productivity Score</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div style="text-align: center; color: var(--text-secondary);">
                        <h3>📈 Study Time This Week</h3>
                        <div style="margin-top: 20px; font-size: 14px;">
                            Mon: 2.5h | Tue: 3.2h | Wed: 1.8h | Thu: 4.1h | Fri: 2.7h | Sat: 1.5h | Sun: 3.0h
                        </div>
                        <div style="margin-top: 20px; padding: 20px; background: var(--bg-secondary); border-radius: 8px;">
                            <strong>Weekly Average: 2.7 hours/day</strong><br>
                            <span style="color: var(--secondary);">↗ 15% improvement from last week</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="about-page" class="page">
                <div class="card" style="max-width: 800px; margin: 0 auto;">
                    <h2 style="text-align: center; color: var(--primary); margin-bottom: 30px; font-size: 28px;">
                        🚀 About Productivity Dashboard
                    </h2>
                    
                    <div style="text-align: center; margin-bottom: 40px;">
                        <div style="font-size: 60px; margin-bottom: 20px;">📊✨</div>
                        <p style="font-size: 18px; color: var(--text-secondary); line-height: 1.8;">
                            Empowering your journey to peak productivity and personal growth
                        </p>
                    </div>

                    <div style="margin-bottom: 40px;">
                        <h3 style="color: var(--primary); margin-bottom: 20px; font-size: 22px;">🎯 Our Mission</h3>
                        <p style="line-height: 1.8; margin-bottom: 20px;">
                            We believe that productivity isn't just about doing more—it's about doing what matters most. 
                            Our dashboard is designed to be your personal command center for building better habits, 
                            achieving your goals, and creating a life you're proud of.
                        </p>
                        <p style="line-height: 1.8;">
                            Whether you're a student preparing for exams, a professional working on projects, or someone 
                            simply looking to build better daily routines, we're here to support your journey with 
                            intuitive tools and motivational insights.
                        </p>
                    </div>

                    <div style="margin-top: 40px;">
                        <h3 style="color: var(--primary); margin-bottom: 20px; font-size: 22px; text-align: center;">👨‍💻 Meet the Creator</h3>
                        <div style="background: var(--bg-secondary); padding: 30px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 15px;">🚀</div>
                            <h4 style="color: var(--primary); font-size: 20px; margin-bottom: 10px;">Shiven Prasad</h4>
                            <p style="color: var(--text-secondary); margin-bottom: 20px; line-height: 1.6;">
                                Passionate developer and productivity enthusiast who believes in the power of 
                                well-designed tools to transform daily routines and unlock human potential.
                            </p>
                            <div style="display: flex; justify-content: center; align-items: center; gap: 15px; flex-wrap: wrap;">
                                <span style="color: var(--text-secondary); font-size: 14px;">Get in touch:</span>
                                <a href="mailto:prasadshiven034@gmail.com" style="
                                    display: inline-flex; 
                                    align-items: center; 
                                    gap: 8px; 
                                    padding: 10px 20px; 
                                    background: var(--primary); 
                                    color: white; 
                                    text-decoration: none; 
                                    border-radius: 25px; 
                                    font-size: 14px;
                                    transition: all 0.3s ease;
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(99, 102, 241, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                                    📧 prasadshiven034@gmail.com
                                </a>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid var(--border);">
                        <p style="color: var(--text-secondary); font-size: 14px;">
                            Built with ❤️ by Shiven Prasad for productivity enthusiasts everywhere<br>
                            <span style="font-size: 12px;">Version 2.0 | Now with Google Authentication & Cloud Sync</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="modal" id="celebration-modal">
        <div class="modal-content">
            <div class="celebration">🎉</div>
            <h3>Congratulations!</h3>
            <p id="celebration-message">Great job completing your task!</p>
            <button class="btn" onclick="closeCelebration()">Continue</button>
        </div>
    </div>

    <script>
        // Firebase Configuration
        // TODO: Replace with your Firebase config
       const firebaseConfig = {
    apiKey: "AIzaSyC1234567890abcdef...",
    authDomain: "productivity-dashboard-12345.firebaseapp.com",
    projectId: "productivity-dashboard-12345",
    storageBucket: "productivity-dashboard-12345.appspot.com",
    messagingSenderId: "123456789012",
    appId: "1:123456789012:web:abc123def456..."
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        let currentUser = null;

        // Application state
        let appState = {
            tasks: [],
            habits: [],
            timer: {
                minutes: 25,
                seconds: 0,
                isRunning: false,
                isPomodoro: true,
                totalTime: 25 * 60,
                interval: null
            },
            stats: {
                studyTime: 0,
                completedTasks: 0,
                bestStreak: 0,
                pomodoroSessions: 0
            },
            darkMode: false
        };

        // Motivational quotes
        const quotes = [
            { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
            { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
            { text: "It is during our darkest moments that we must focus to see the light.", author: "Aristotle" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "The only impossible journey is the one you never begin.", author: "Tony Robbins" }
        ];

        // Authentication Functions
        function signInWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    console.log('User signed in successfully');
                })
                .catch((error) => {
                    console.error('Error signing in:', error);
                    alert('Error signing in. Please try again.');
                });
        }

        function signOut() {
            auth.signOut().then(() => {
                console.log('User signed out successfully');
            }).catch((error) => {
                console.error('Error signing out:', error);
            });
        }

        // Auth state observer
        auth.onAuthStateChanged((user) => {
            const loadingScreen = document.getElementById('loading-screen');
            const loginScreen = document.getElementById('login-screen');
            const appContent = document.getElementById('app-content');
            
            if (user) {
                // User is signed in
                currentUser = user;
                document.getElementById('user-name').textContent = user.displayName;
                document.getElementById('user-avatar').src = user.photoURL;
                
                // Hide loading and login screens, show app
                loadingScreen.classList.remove('active');
                loginScreen.style.display = 'none';
                appContent.classList.add('active');
                
                // Load user data
                loadUserData();
            } else {
                // User is signed out
                currentUser = null;
                
                // Hide loading and app, show login screen
                loadingScreen.classList.remove('active');
                loginScreen.style.display = 'flex';
                appContent.classList.remove('active');
            }
        });

        // Firestore Functions
        async function saveUserData() {
            if (!currentUser) return;
            
            try {
                await db.collection('users').doc(currentUser.uid).set({
                    tasks: appState.tasks,
                    habits: appState.habits,
                    stats: appState.stats,
                    darkMode: appState.darkMode,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                });
                console.log('Data saved successfully');
            } catch (error) {
                console.error('Error saving data:', error);
            }
        }

        async function loadUserData() {
            if (!currentUser) return;
            
            try {
                const doc = await db.collection('users').doc(currentUser.uid).get();
                if (doc.exists) {
                    const data = doc.data();
                    appState.tasks = data.tasks || [];
                    appState.habits = data.habits || [];
                    appState.stats = data.stats || {
                        studyTime: 0,
                        completedTasks: 0,
                        bestStreak: 0,
                        pomodoroSessions: 0
                    };
                    appState.darkMode = data.darkMode || false;
                    
                    // Apply dark mode if enabled
                    if (appState.darkMode) {
                        document.body.setAttribute('data-theme', 'dark');
                        document.querySelector('.dark-toggle').textContent = '☀️';
                    }
                    
                    updateUI();
                    console.log('Data loaded successfully');
                } else {
                    // First time user, initialize with default data
                    console.log('New user, initializing default data');
                    init();
                }
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Initialize app
        function init() {
            updateUI();
            displayRandomQuote();
            updateStats();
        }

        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(pageId + '-page').classList.add('active');
            event.target.classList.add('active');
        }

        // Dark mode toggle
        function toggleDarkMode() {
            appState.darkMode = !appState.darkMode;
            document.body.setAttribute('data-theme', appState.darkMode ? 'dark' : 'light');
            document.querySelector('.dark-toggle').textContent = appState.darkMode ? '☀️' : '🌙';
            saveUserData();
        }

        // Task management
        function addTask() {
            const input = document.getElementById('task-input');
            const taskText = input.value.trim();
            
            if (taskText) {
                const task = {
                    id: Date.now(),
                    text: taskText,
                    completed: false,
                    createdAt: new Date().toISOString()
                };
                appState.tasks.push(task);
                input.value = '';
                updateTaskList();
                saveUserData();
            }
        }

        function handleTaskInput(event) {
            if (event.key === 'Enter') {
                addTask();
            }
        }

        function toggleTask(taskId) {
            const task = appState.tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                if (task.completed) {
                    appState.stats.completedTasks++;
                    showCelebration("Task completed! Keep up the great work! 🎯");
                } else {
                    appState.stats.completedTasks--;
                }
                updateTaskList();
                updateStats();
                saveUserData();
            }
        }

        function deleteTask(taskId) {
            appState.tasks = appState.tasks.filter(t => t.id !== taskId);
            updateTaskList();
            saveUserData();
        }

        function updateTaskList() {
            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';

            appState.tasks.forEach(task => {
                const li = document.createElement('li');
                li.className = `task-item ${task.completed ? 'completed' : ''}`;
                li.innerHTML = `
                    <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''} 
                           onchange="toggleTask(${task.id})">
                    <span>${task.text}</span>
                    <button class="btn btn-danger" style="margin-left: auto; padding: 5px 10px; font-size: 12px;" 
                            onclick="deleteTask(${task.id})">Delete</button>
                `;
                taskList.appendChild(li);
            });
        }

        // Timer functionality
        function startTimer() {
            if (!appState.timer.isRunning) {
                appState.timer.isRunning = true;
                appState.timer.interval = setInterval(updateTimer, 1000);
            }
        }

        function pauseTimer() {
            appState.timer.isRunning = false;
            if (appState.timer.interval) {
                clearInterval(appState.timer.interval);
            }
        }

        function resetTimer() {
            pauseTimer();
            const mode = document.querySelector('input[name="timer-mode"]:checked').value;
            appState.timer.minutes = mode === 'pomodoro' ? 25 : 5;
            appState.timer.seconds = 0;
            appState.timer.totalTime = (mode === 'pomodoro' ? 25 : 5) * 60;
            updateTimerDisplay();
        }

        function updateTimer() {
            if (appState.timer.seconds === 0) {
                if (appState.timer.minutes === 0) {
                    timerComplete();
                    return;
                }
                appState.timer.minutes--;
                appState.timer.seconds = 59;
            } else {
                appState.timer.seconds--;
            }
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const display = document.getElementById('timer-display');
            const progress = document.getElementById('timer-progress');
            
            const totalSeconds = appState.timer.minutes * 60 + appState.timer.seconds;
            const progressPercent = ((appState.timer.totalTime - totalSeconds) / appState.timer.totalTime) * 100;
            
            display.textContent = `${appState.timer.minutes.toString().padStart(2, '0')}:${appState.timer.seconds.toString().padStart(2, '0')}`;
            progress.style.width = progressPercent + '%';
        }

        function timerComplete() {
            pauseTimer();
            const mode = document.querySelector('input[name="timer-mode"]:checked').value;
            
            if (mode === 'pomodoro') {
                appState.stats.pomodoroSessions++;
                appState.stats.studyTime += 0.42; // 25 minutes in hours
                showCelebration("Pomodoro session complete! Time for a break! 🍅");
            } else {
                showCelebration("Break time over! Ready for another productive session? ⚡");
            }
            
            updateStats();
            saveUserData();
        }

        // Habit management
        function addHabit() {
            const input = document.getElementById('habit-input');
            const habitText = input.value.trim();
            
            if (habitText) {
                const habit = {
                    id: Date.now(),
                    text: habitText,
                    streak: 0,
                    lastCompleted: null,
                    createdAt: new Date().toISOString()
                };
                appState.habits.push(habit);
                input.value = '';
                updateHabitList();
                saveUserData();
            }
        }

        function handleHabitInput(event) {
            if (event.key === 'Enter') {
                addHabit();
            }
        }

        function completeHabit(habitId) {
            const habit = appState.habits.find(h => h.id === habitId);
            if (habit) {
                const today = new Date().toDateString();
                const lastCompleted = habit.lastCompleted ? new Date(habit.lastCompleted).toDateString() : null;
                
                if (lastCompleted !== today) {
                    habit.streak++;
                    habit.lastCompleted = new Date().toISOString();
                    
                    if (habit.streak > appState.stats.bestStreak) {
                        appState.stats.bestStreak = habit.streak;
                    }
                    
                    showCelebration(`Habit completed! ${habit.streak} day streak! 🔥`);
                    updateHabitList();
                    updateStats();
                    saveUserData();
                }
            }
        }

        function deleteHabit(habitId) {
            appState.habits = appState.habits.filter(h => h.id !== habitId);
            updateHabitList();
            saveUserData();
        }

        function updateHabitList() {
            const habitList = document.getElementById('habit-list');
            habitList.innerHTML = '';

            appState.habits.forEach(habit => {
                const div = document.createElement('div');
                div.className = 'habit-item';
                
                const today = new Date().toDateString();
                const lastCompleted = habit.lastCompleted ? new Date(habit.lastCompleted).toDateString() : null;
                const completedToday = lastCompleted === today;
                
                div.innerHTML = `
                    <div>
                        <strong>${habit.text}</strong>
                        ${completedToday ? '<span style="color: var(--secondary); margin-left: 10px;">✓ Done today</span>' : ''}
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span class="habit-streak">${habit.streak} days</span>
                        ${!completedToday ? `<button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="completeHabit(${habit.id})">Complete</button>` : ''}
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteHabit(${habit.id})">Delete</button>
                    </div>
                `;
                habitList.appendChild(div);
            });
        }

        // Quote system
        function displayRandomQuote() {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('quote-text').textContent = `"${randomQuote.text}"`;
            document.getElementById('quote-author').textContent = `- ${randomQuote.author}`;
        }

        function newQuote() {
            displayRandomQuote();
        }

        // Statistics
        function updateStats() {
            document.getElementById('total-study-time').textContent = appState.stats.studyTime.toFixed(1);
            document.getElementById('completed-tasks').textContent = appState.stats.completedTasks;
            document.getElementById('habit-streak').textContent = appState.stats.bestStreak;
            
            const completedToday = appState.tasks.filter(t => t.completed).length;
            const totalToday = appState.tasks.length;
            const productivityScore = totalToday > 0 ? Math.round((completedToday / totalToday) * 100) : 0;
            document.getElementById('productivity-score').textContent = productivityScore + '%';
        }

        // Celebration modal
        function showCelebration(message) {
            document.getElementById('celebration-message').textContent = message;
            document.getElementById('celebration-modal').classList.add('active');
        }

        function closeCelebration() {
            document.getElementById('celebration-modal').classList.remove('active');
        }

        function updateUI() {
            updateTaskList();
            updateHabitList();
            updateTimerDisplay();
            updateStats();
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // The auth state observer will handle initialization
            console.log('App loaded, waiting for auth state...');
        });
    </script>
</body>
</html>
